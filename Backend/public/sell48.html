<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sell in 48 Hours Guaranteed | Cars And Bikes In India-CABII</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Segoe UI', Tahoma, Geneva, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  padding: 20px 0;
}

.page-wrapper { display: flex; min-height: 100vh; gap: 0; }

.main-content { flex: 1; }

.header {
  background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
  color: white;
  padding: 30px;
  text-align: center;
  box-shadow: 0 8px 32px rgba(0,0,0,0.3);
}
.header h1 { font-size: 36px; margin-bottom: 8px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
.header p { font-size: 16px; opacity: 0.95; }

.membership-required {
  background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
  border-left: 5px solid #dc2626;
  padding: 25px;
  border-radius: 12px;
  margin: 30px auto;
  max-width: 900px;
  text-align: center;
  display: none;
}
.membership-required.show { display: block; }
.membership-required h2 { color: #991b1b; margin-bottom: 12px; font-size: 22px; }
.membership-required p { color: #7f1d1d; margin-bottom: 15px; line-height: 1.6; }
.membership-required .btn-primary { margin: 0 auto; }

.container {
  max-width: 900px;
  margin: 30px auto;
  background: white;
  padding: 40px;
  border-radius: 16px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  display: none;
}
.container.show { display: block; }

.section-title {
  font-size: 22px;
  font-weight: 700;
  color: #dc2626;
  margin: 30px 0 20px 0;
  padding-bottom: 12px;
  border-bottom: 3px solid #dc2626;
  display: flex;
  align-items: center;
  gap: 12px;
}

.form-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 20px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

label {
  font-weight: 700;
  color: #1f2937;
  margin-bottom: 8px;
  font-size: 14px;
}

input, select, textarea {
  padding: 14px;
  border: 2px solid #e5e7eb;
  border-radius: 10px;
  font-size: 14px;
  font-family: inherit;
  transition: all 0.3s;
  background: white;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: #dc2626;
  box-shadow: 0 0 0 4px rgba(220, 38, 38, 0.1);
  background: #fef2f2;
}

select { cursor: pointer; }

textarea { resize: vertical; min-height: 120px; }

.required-badge {
  background: #dc2626;
  color: white;
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 4px;
  font-weight: 700;
  display: inline-block;
  margin-left: 6px;
}

.photo-section {
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
  padding: 25px;
  border-radius: 12px;
  border-left: 5px solid #dc2626;
  margin: 25px 0;
}

.photo-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 16px;
  margin-top: 18px;
}

.photo-upload {
  border: 2px dashed #dc2626;
  border-radius: 12px;
  padding: 15px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s;
  background: white;
  position: relative;
  min-height: 220px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.photo-upload:hover { background: #fef2f2; border-color: #991b1b; transform: translateY(-3px); box-shadow: 0 8px 16px rgba(220, 38, 38, 0.15); }
.photo-upload input[type="file"] { display: none; }

.photo-label {
  font-size: 14px;
  font-weight: 700;
  color: #dc2626;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  cursor: pointer;
}
.photo-label span { font-size: 32px; }

.photo-preview-container {
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
  height: 150px;
  display: none;
  cursor: pointer;
  transition: all 0.3s;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  border: 2px solid #e5e7eb;
}

.photo-preview-container:hover {
  transform: scale(1.02);
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}

.photo-preview-container:hover .remove-btn {
  opacity: 1;
  visibility: visible;
}

.photo-preview-container img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  cursor: pointer;
}

.remove-btn {
  position: absolute;
  top: 8px;
  right: 8px;
  background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
  color: white;
  border: 2px solid white;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  cursor: pointer;
  font-weight: bold;
  font-size: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 15;
  box-shadow: 0 4px 12px rgba(220, 38, 38, 0.5);
  transition: all 0.2s;
  line-height: 1;
  opacity: 0;
  visibility: hidden;
}
.remove-btn:hover {
  background: linear-gradient(135deg, #991b1b 0%, #7f1d1d 100%);
  transform: scale(1.15);
  box-shadow: 0 6px 16px rgba(220, 38, 38, 0.7);
}

.btn-group {
  display: flex;
  gap: 12px;
  margin-top: 30px;
  flex-wrap: wrap;
}

button {
  padding: 14px 28px;
  border: none;
  border-radius: 10px;
  font-size: 15px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-primary {
  background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
  color: white;
  box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
}
.btn-primary:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(220, 38, 38, 0.4);
}
.btn-primary:disabled { background: #9ca3af; cursor: not-allowed; transform: none; }

.btn-secondary {
  background: #667eea;
  color: white;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}
.btn-secondary:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

.analysis-box {
  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
  border-left: 5px solid #16a34a;
  padding: 25px;
  border-radius: 12px;
  margin: 25px 0;
  display: none;
}
.analysis-box.show { display: block; }

.analysis-title {
  font-size: 20px;
  font-weight: 700;
  color: #16a34a;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.analysis-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
}

.analysis-item {
  background: white;
  padding: 18px;
  border-radius: 10px;
  border-left: 4px solid #16a34a;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}
.analysis-item .label { font-size: 12px; color: #666; font-weight: 600; }
.analysis-item .value { font-size: 24px; font-weight: 900; color: #16a34a; margin-top: 8px; }

.message {
  padding: 18px;
  border-radius: 10px;
  margin: 20px 0;
  font-weight: 600;
  display: none;
  border-left: 5px solid;
  animation: slideIn 0.3s ease;
}
.message.show { display: block; }
.message.success {
  background: #dcfce7;
  color: #166534;
  border-color: #16a34a;
}
.message.error {
  background: #fee2e2;
  color: #991b1b;
  border-color: #dc2626;
}

@keyframes slideIn {
  from { transform: translateY(-10px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.analysis-modal-content {
  background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
  border-radius: 20px;
  max-width: 500px;
  width: 90%;
  padding: 40px;
  position: relative;
  box-shadow: 0 25px 50px rgba(0,0,0,0.3);
  border: 3px solid #16a34a;
  animation: slideUp 0.4s ease;
}

@keyframes slideUp {
  from { transform: translateY(30px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.analysis-modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: #dc2626;
  border: none;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

.analysis-modal-close:hover {
  background: #991b1b;
}

.analysis-modal-title {
  font-size: 28px;
  font-weight: 900;
  color: #16a34a;
  margin-bottom: 25px;
  text-align: center;
}

.analysis-modal-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-bottom: 30px;
}

.analysis-modal-item {
  background: linear-gradient(135deg, #f0fdf4 0%, #e0f2fe 100%);
  padding: 20px;
  border-radius: 12px;
  border-left: 4px solid #16a34a;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.analysis-modal-item .label {
  font-size: 13px;
  color: #666;
  font-weight: 600;
  margin-bottom: 10px;
}

.analysis-modal-item .value {
  font-size: 28px;
  font-weight: 900;
  color: #16a34a;
  word-break: break-word;
}

.analysis-modal-status {
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
  border: 2px solid #dc2626;
  padding: 20px;
  border-radius: 12px;
  text-align: center;
  margin-bottom: 25px;
}

.analysis-modal-status .label {
  font-size: 14px;
  color: #991b1b;
  font-weight: 600;
  margin-bottom: 10px;
}

.analysis-modal-status .value {
  font-size: 24px;
  font-weight: 900;
  color: #dc2626;
}

.analysis-modal-btn {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(22, 163, 74, 0.3);
  transition: all 0.3s;
}

.analysis-modal-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(22, 163, 74, 0.4);
}

/* ===== ZOOM MODAL ===== */
.zoom-modal-content {
  background: #000;
  border-radius: 16px;
  max-width: 90vw;
  max-height: 90vh;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  animation: slideUp 0.4s ease;
}

.zoom-image {
  max-width: 100%;
  max-height: 85vh;
  object-fit: contain;
  border-radius: 12px;
}

.zoom-modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
  border: 2px solid white;
  color: white;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 20;
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
  transition: all 0.2s;
}

.zoom-modal-close:hover {
  background: linear-gradient(135deg, #991b1b 0%, #7f1d1d 100%);
  transform: scale(1.1);
}

.zoom-photo-name {
  position: absolute;
  bottom: 15px;
  left: 15px;
  background: rgba(0,0,0,0.8);
  color: white;
  padding: 12px 20px;
  border-radius: 8px;
  font-weight: 700;
  font-size: 14px;
}

.spinner {
  display: inline-block;
  width: 14px;
  height: 14px;
  border: 2px solid currentColor;
  border-radius: 50%;
  border-top-color: transparent;
  animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  z-index: 10000;
  align-items: center;
  justify-content: center;
}
.modal.show { display: flex; }

.modal-content {
  background: white;
  border-radius: 16px;
  max-width: 600px;
  width: 90%;
  max-height: 80vh;
  overflow: auto;
  position: relative;
}

.modal-header {
  background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
  color: white;
  padding: 25px;
  font-size: 22px;
  font-weight: 700;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-close {
  background: none;
  border: none;
  color: white;
  font-size: 32px;
  cursor: pointer;
  padding: 0;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-body { padding: 25px; }

.photo-grid-modal {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
}

.photo-modal-item {
  position: relative;
  border-radius: 10px;
  overflow: hidden;
  background: #000;
}
.photo-modal-item img {
  width: 100%;
  height: 150px;
  object-fit: cover;
  cursor: pointer;
  transition: transform 0.3s;
}
.photo-modal-item img:hover { transform: scale(1.05); }
.photo-modal-item .photo-name {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(0,0,0,0.8);
  color: white;
  padding: 8px;
  font-size: 12px;
  font-weight: 700;
}

.sidebar {
  width: 280px;
  background: white;
  padding: 25px;
  box-shadow: -4px 0 15px rgba(0,0,0,0.1);
  overflow-y: auto;
  position: sticky;
  top: 0;
  height: 100vh;
}

.sidebar-title {
  font-size: 18px;
  font-weight: 900;
  color: #dc2626;
  margin-bottom: 20px;
  text-align: center;
  padding-bottom: 15px;
  border-bottom: 3px solid #dc2626;
}

.plan-card {
  background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
  border: 2px solid #dc2626;
  border-radius: 12px;
  padding: 18px;
  margin-bottom: 15px;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
}
.plan-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 20px rgba(220, 38, 38, 0.2);
  border-color: #991b1b;
}
.plan-card.silver { background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); border-color: #4f46e5; }
.plan-card.gold { background: linear-gradient(135deg, #fef08a 0%, #fde047 100%); border-color: #ca8a04; }
.plan-card.platinum { background: linear-gradient(135deg, #f5e6ff 0%, #e9d5ff 100%); border-color: #a855f7; }
.plan-card.selected { border: 3px solid #16a34a; box-shadow: 0 0 15px rgba(22, 163, 74, 0.3); }

.plan-name { font-weight: 700; color: #dc2626; margin-bottom: 8px; font-size: 15px; }
.plan-price { font-size: 28px; font-weight: 900; color: #991b1b; margin-bottom: 5px; }
.plan-features {
  font-size: 12px;
  color: #666;
  margin-top: 10px;
  line-height: 1.6;
}

.select-btn {
  width: 100%;
  margin-top: 12px;
  padding: 10px;
  background: #dc2626;
  color: white;
  border: none;
  border-radius: 8px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
}
.select-btn:hover { background: #991b1b; }
.select-btn.selected { background: #16a34a; }

@media (max-width: 1200px) {
  .page-wrapper { flex-direction: column; }
  .sidebar { width: 100%; height: auto; position: static; }
}

@media (max-width: 768px) {
  .container { padding: 20px; }
  .form-grid { grid-template-columns: 1fr; }
  .photo-grid { grid-template-columns: repeat(2, 1fr); }
  .header h1 { font-size: 24px; }
}
/* üîí Hide dealer membership sidebar for sellers */
.sidebar {
  display: none !important;
}
</style>
</head>
<body>
<body>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const user = localStorage.getItem("cabiiUser");
  if (!user) {
    alert("üîê Please login to access Sell in 48 Hours");
    window.location.href = "login.html";
  }
});
</script>
<div class="page-wrapper">
  <div class="main-content">
    <div class="header">
      <h1>üöÄ Sell in 48 Hours Guaranteed</h1>
      <p>Upload your vehicle & get instant dealer matches. Guaranteed sale within 48 hours!</p>
    </div>

    <div class="membership-required" id="membershipRequired">
      <h2>üíé Dealer's Membership Required</h2>
      <p>Select a membership plan from the right panel to unlock the form and reach dealers instantly!</p>
      <p style="font-size: 13px; margin-top: 15px;">After membership purchase, dealers will get instant WhatsApp notifications for all new listings.</p>
    </div>

    <div class="container" id="formContainer">
      <div class="message" id="successMsg"></div>
      <div class="message" id="errorMsg"></div>

      <form id="sell48Form" enctype="multipart/form-data">

        <!-- STEP 1: VEHICLE DETAILS -->
        <div class="section-title">üöó Step 1: Vehicle Details</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Brand Name <span class="required-badge">REQUIRED</span></label>
            <select id="brandSelect" required onchange="updateDescription()">
              <option value="">-- Select Brand --</option>
              <option value="Maruti">Maruti</option>
              <option value="Hyundai">Hyundai</option>
              <option value="Tata">Tata</option>
              <option value="Mahindra">Mahindra</option>
              <option value="Honda">Honda</option>
              <option value="Toyota">Toyota</option>
              <option value="Bajaj">Bajaj</option>
              <option value="Skoda">Skoda</option>
              <option value="Volkswagen">Volkswagen</option>
              <option value="Kia">Kia</option>
              <option value="MG">MG</option>
              <option value="Renault">Renault</option>
              <option value="Datsun">Datsun</option>
              <option value="Ford">Ford</option>
              <option value="BMW">BMW</option>
              <option value="Mercedes">Mercedes</option>
              <option value="Audi">Audi</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label>Model Name <span class="required-badge">REQUIRED</span></label>
            <input type="text" id="modelField" placeholder="e.g., Swift, City, Creta" required onchange="updateDescription()">
          </div>
          <div class="form-group">
            <label>Manufacture Year <span class="required-badge">REQUIRED</span></label>
            <input type="number" id="yearField" placeholder="e.g., 2020" min="2000" max="2026" required onchange="updateDescription()">
          </div>
          <div class="form-group">
            <label>Insurance</label>
            <select id="insuranceType" onchange="updateDescription()">
              <option value="Third Party">Third Party</option>
              <option value="Comprehensive">Comprehensive</option>
              <option value="No Insurance">No Insurance</option>
            </select>
          </div>
          <div class="form-group">
            <label>Owner</label>
            <select id="ownerType" onchange="updateDescription()">
              <option value="First Owner">First Owner</option>
              <option value="Second Owner">Second Owner</option>
              <option value="Third Owner">Third Owner</option>
              <option value="Fourth+ Owner">Fourth+ Owner</option>
            </select>
          </div>
        </div>

        <!-- STEP 2: CONDITION DETAILS -->
        <div class="section-title">‚öôÔ∏è Step 2: Condition & Specs</div>
        <div class="form-grid">
          <div class="form-group">
            <label>KM Driven <span class="required-badge">REQUIRED</span></label>
            <input type="number" id="kmField" placeholder="e.g., " required onchange="calculateMarketPrice()">
          </div>
          <div class="form-group">
            <label>Fuel Type <span class="required-badge">REQUIRED</span></label>
            <select id="fuelSelect" required onchange="updateDescription()">
              <option value="">-- Select Fuel --</option>
              <option value="Petrol">Petrol</option>
              <option value="Diesel">Diesel</option>
              <option value="CNG">CNG</option>
              <option value="LPG">LPG</option>
              <option value="Electric">Electric</option>
              <option value="Hybrid">Hybrid</option>
            </select>
          </div>
          <div class="form-group">
            <label>Transmission <span class="required-badge">REQUIRED</span></label>
            <select id="transmissionSelect" required onchange="updateDescription()">
              <option value="">-- Select Transmission --</option>
              <option value="Manual">Manual</option>
              <option value="Automatic">Automatic</option>
              <option value="CVT">CVT</option>
              <option value="AMT">AMT</option>
            </select>
          </div>
          <div class="form-group">
            <label>Car Condition</label>
            <select id="conditionSelect" onchange="calculateMarketPrice()">
              <option value="Excellent">Excellent</option>
              <option value="Good">Good</option>
              <option value="Average">Average</option>
              <option value="Fair">Fair</option>
            </select>
          </div>
        </div>

        <!-- STEP 3: EXPECTED PRICE -->
        <div class="section-title">üí∞ Step 3: Expected Price</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Expected Price (‚Çπ) <span class="required-badge">REQUIRED</span></label>
            <input type="number" id="expectedPrice" placeholder="Enter your expected price" required onchange="calculateMarketPrice()">
          </div>
        </div>
<!-- üî• 48H GUARANTEE RESULT -->
<div id="guaranteeBox"
     style="margin-top:15px;font-weight:700;font-size:15px;">
</div>
<input type="hidden" id="guaranteeEligible" value="false">
        <!-- MARKET ANALYSIS (AUTO-SHOWS WHEN PRICE IS ENTERED) -->
        <div class="analysis-box" id="analysisBox">
          <div class="analysis-title">üìä Market Analysis Results</div>
          <div class="analysis-grid">
            <div class="analysis-item">
              <div class="label">Buyer Range (Low)</div>
              <div class="value" id="lowPrice">‚Çπ0</div>
            </div>
            <div class="analysis-item">
              <div class="label">Fair Market Price</div>
              <div class="value" id="fairPrice">‚Çπ0</div>
            </div>
            <div class="analysis-item">
              <div class="label">Buyer Range (High)</div>
              <div class="value" id="highPrice">‚Çπ0</div>
            </div>
            <div class="analysis-item">
              <div class="label">Your Price Status</div>
              <div class="value" id="priceStatus">Competitive</div>
            </div>
          </div>
        </div>

        <!-- STEP 4: VEHICLE PHOTOS -->
        <div class="section-title">üì∑ Step 4: Vehicle Photos <span class="required-badge">7 REQUIRED</span></div>
        <div class="photo-section">
          <div class="photo-grid">
            <div class="photo-upload" onclick="document.getElementById('frontPhoto').click()">
              <input type="file" id="frontPhoto" accept="image/*" data-type="front">
              <label class="photo-label"><span>üîµ</span> Front</label>
              <div class="photo-preview-container" id="frontPreview"></div>
            </div>

            <div class="photo-upload" onclick="document.getElementById('backPhoto').click()">
              <input type="file" id="backPhoto" accept="image/*" data-type="back">
              <label class="photo-label"><span>üü°</span> Back</label>
              <div class="photo-preview-container" id="backPreview"></div>
            </div>

            <div class="photo-upload" onclick="document.getElementById('roofPhoto').click()">
              <input type="file" id="roofPhoto" accept="image/*" data-type="roof">
              <label class="photo-label"><span>‚ö™</span> Roof</label>
              <div class="photo-preview-container" id="roofPreview"></div>
            </div>

            <div class="photo-upload" onclick="document.getElementById('rightPhoto').click()">
              <input type="file" id="rightPhoto" accept="image/*" data-type="right">
              <label class="photo-label"><span>üü¢</span> Right Side</label>
              <div class="photo-preview-container" id="rightPreview"></div>
            </div>

            <div class="photo-upload" onclick="document.getElementById('leftPhoto').click()">
              <input type="file" id="leftPhoto" accept="image/*" data-type="left">
              <label class="photo-label"><span>üü£</span> Left Side</label>
              <div class="photo-preview-container" id="leftPreview"></div>
            </div>

            <div class="photo-upload" onclick="document.getElementById('kmPhoto').click()">
              <input type="file" id="kmPhoto" accept="image/*" data-type="km">
              <label class="photo-label"><span>üìä</span> Odometer</label>
              <div class="photo-preview-container" id="kmPreview"></div>
            </div>

            <div class="photo-upload" onclick="document.getElementById('interiorPhoto').click()">
              <input type="file" id="interiorPhoto" accept="image/*" data-type="interior">
              <label class="photo-label"><span>ü™ë</span> Interior</label>
              <div class="photo-preview-container" id="interiorPreview"></div>
            </div>
          </div>
          <button type="button" class="btn-secondary" style="width: 100%; margin-top: 15px;" onclick="showPhotoModal()">
            üëÅÔ∏è Preview All Photos
          </button>
        </div>

        <!-- STEP 5: DESCRIPTION -->
        <div class="section-title">üìù Step 5: Vehicle Description</div>
        <div class="form-group" style="margin: 20px 0;">
          <label>Description (Auto-generated, edit manually as needed)</label>
          <textarea id="descField" required></textarea>
          <button type="button" class="btn-secondary" style="margin-top: 10px;" onclick="generateDescription()">
            ü§ñ Regenerate Description
          </button>
        </div>

        <!-- STEP 6: SELLER INFO -->
        <div class="section-title">üë§ Step 6: Your Information</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Full Name <span class="required-badge">REQUIRED</span></label>
            <input type="text" id="sellerName" placeholder="Your full name" required>
          </div>
          <div class="form-group">
            <label>Contact Number <span class="required-badge">REQUIRED</span></label>
            <input type="tel" id="sellerPhone" placeholder="10-digit number" pattern="[0-9]{10}" required>
          </div>
          <div class="form-group">
            <label>Location/City</label>
            <input type="text" id="sellerCity" placeholder="Your city">
          </div>
          <div class="form-group">
            <label>WhatsApp Number (for dealer notifications)</label>
            <input type="tel" id="whatsappNum" placeholder="10-digit number" pattern="[0-9]{10}">
          </div>
        </div>

        <!-- SUBMIT BUTTONS -->
        <div class="btn-group">
          <button type="submit" class="btn-primary" id="submitBtn">
            üöÄ Post 48H Guarantee Ad
          </button>
        </div>

      </form>

    </div>
  </div>

 <!-- SIDEBAR - MEMBERSHIP PLANS -->
<div class="sidebar">
  <div class="sidebar-title">üíé Dealer Membership (Only for Buyers)</div>
  <p style="font-size: 12px; color: #666; text-align: center; margin-bottom: 20px;">
    Select a plan to access the selling form
  </p>

  <div class="plan-card silver" id="silverPlan">
    <div class="plan-name">üü¶ Silver</div>
    <div class="plan-price">‚Çπ999</div>
    <div class="plan-features">
      ‚Ä¢ 1 Month Validity<br>
      ‚Ä¢ 2 Guaranteed Leads<br>
      ‚Ä¢ Basic Support<br>
      ‚Ä¢ Seller Badge
    </div>
    <button class="select-btn" onclick="selectMembership('silver',999,this)">
      Select Silver
    </button>
  </div>

  <div class="plan-card gold" id="goldPlan">
    <div class="plan-name">üü® Gold</div>
    <div class="plan-price">‚Çπ4999</div>
    <div class="plan-features">
      ‚Ä¢ 2 Months Validity<br>
      ‚Ä¢ 10 Guaranteed Leads<br>
      ‚Ä¢ Priority Support<br>
      ‚Ä¢ Premium Badge<br>
      ‚Ä¢ Dealer Direct Access
    </div>
    <button class="select-btn" onclick="selectMembership('gold',4999,this)">
      Select Gold
    </button>
  </div>

  <div class="plan-card platinum" id="platinumPlan">
    <div class="plan-name">üü™ Platinum</div>
    <div class="plan-price">‚Çπ9999</div>
    <div class="plan-features">
      ‚Ä¢ 3 Month Validity<br>
      ‚Ä¢ 20 Guaranteed Leads<br>
      ‚Ä¢ 24/7 Support<br>
      ‚Ä¢ VIP Badge<br>
      ‚Ä¢ Exclusive Dealer Network<br>
      ‚Ä¢ WhatsApp Premium
    </div>
    <button class="select-btn" onclick="selectMembership('platinum',9999,this)">
      Select Platinum
    </button>
  </div>

  <div id="membershipNote"
    style="display:none;background:#f0fdf4;padding:15px;border-radius:10px;
    border-left:3px solid #16a34a;margin-top:20px;font-size:12px;
    color:#166534;line-height:1.6;">
  </div>
</div>

<!-- MEMBERSHIP SCRIPT -->
<!-- PHOTO PREVIEW MODAL -->
<div class="modal" id="photoModal">
  <div class="modal-content">
    <div class="modal-header">
      üì∏ Preview All Photos
      <button class="modal-close" onclick="closePhotoModal()">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="photo-grid-modal" id="photoGrid"></div>
    </div>
  </div>
</div>

<!-- MARKET ANALYSIS MODAL -->
<div class="modal" id="analysisModal">
  <div class="analysis-modal-content">
    <button class="analysis-modal-close" onclick="closeAnalysisModal()">‚úï</button>
    <div class="analysis-modal-title">üìä Market Analysis Ready!</div>
    
    <div class="analysis-modal-grid">
      <div class="analysis-modal-item">
        <div class="label">Low Price Range</div>
        <div class="value" id="modalLowPrice">‚Çπ0</div>
      </div>
      <div class="analysis-modal-item">
        <div class="label">High Price Range</div>
        <div class="value" id="modalHighPrice">‚Çπ0</div>
      </div>
      <div class="analysis-modal-item">
        <div class="label">Fair Market Price</div>
        <div class="value" id="modalFairPrice">‚Çπ0</div>
      </div>
      <div class="analysis-modal-item">
        <div class="label">Your Ask Price</div>
        <div class="value" id="modalYourPrice">‚Çπ0</div>
      </div>
    </div>

    <div class="analysis-modal-status">
      <div class="label">Price Status</div>
      <div class="value" id="modalPriceStatus">Analyzing...</div>
    </div>

    <button class="analysis-modal-btn" onclick="closeAnalysisModal()">‚úÖ Proceed to Fill Form</button>
  </div>
</div>

<!-- PHOTO ZOOM MODAL -->
<div class="modal" id="zoomModal">
  <div class="zoom-modal-content">
    <button class="zoom-modal-close" onclick="closeZoomModal()">‚úï</button>
    <img id="zoomImage" src="" alt="Zoomed photo" class="zoom-image">
    <div class="zoom-photo-name" id="zoomPhotoName"></div>
  </div>
</div>

<script>
 window.sell48PaymentDone = false;
window.sell48PaymentId = null; 
let uploadedPhotos = {};
let selectedMembership = null;
let membershipLeads = 0;
let membershipMonths = 0;
let membershipPrice = 0;
const form = document.getElementById('sell48Form');
const successMsg = document.getElementById('successMsg');
const errorMsg = document.getElementById('errorMsg');
const formContainer = document.getElementById('formContainer');
const membershipRequired = document.getElementById('membershipRequired');

// ===== MEMBERSHIP SELECTION =====
function selectMembership(plan, price) {
  selectedMembership = plan;
  membershipPrice = price;

  if (plan === "silver") {
    membershipLeads = 2;
    membershipMonths = 1;
  }
  if (plan === "gold") {
    membershipLeads = 10;
    membershipMonths = 2;
  }
  if (plan === "platinum") {
    membershipLeads = 20;
    membershipMonths = 3;
  }

  document.querySelectorAll('.plan-card').forEach(c => c.classList.remove('selected'));
  document.querySelectorAll('.select-btn').forEach(b => b.classList.remove('selected'));

  document.getElementById(plan + "Plan").classList.add("selected");
  document.getElementById(plan + "Plan").querySelector(".select-btn").classList.add("selected");

  membershipRequired.classList.remove('show');
  formContainer.classList.add('show');

  successMsg.innerHTML =
    `‚úÖ <b>${plan.toUpperCase()} PLAN ACTIVE</b><br>
     ‚Ä¢ Leads: ${membershipLeads}<br>
     ‚Ä¢ Validity: ${membershipMonths} Month(s)`;
  successMsg.classList.add('show');
}
// ===== PHOTO UPLOAD HANDLERS =====
const photoInputs = ['frontPhoto', 'backPhoto', 'roofPhoto', 'rightPhoto', 'leftPhoto', 'kmPhoto', 'interiorPhoto'];

photoInputs.forEach(inputId => {
  const input = document.getElementById(inputId);
  input.addEventListener('change', handlePhotoUpload);
});

function handlePhotoUpload(e) {
  const file = e.target.files[0];
  if (!file) return;

  const type = e.target.dataset.type;
  const reader = new FileReader();
  // üîí ODOMETER PHOTO BASIC CHECK
if (type === "km" && !file.name.toLowerCase().includes("odo")) {
  alert("‚ö†Ô∏è Please upload a CLEAR ODOMETER photo");
}

  reader.onload = function(evt) {
    uploadedPhotos[type] = { file: file, preview: evt.target.result, name: type.toUpperCase() };
    
    const previewId = type + 'Preview';
    const preview = document.getElementById(previewId);
    
    preview.innerHTML = `
      <img src="${evt.target.result}" alt="${type}" style="width: 100%; height: 100%; object-fit: cover; cursor: pointer;" onclick="openZoom('${evt.target.result}', '${type.toUpperCase()}')">
      <button type="button" class="remove-btn" onclick="removePhoto('${type}')">‚úï</button>
    `;
    preview.style.display = 'block';
  };
  
  reader.readAsDataURL(file);
}

function removePhoto(type) {
  delete uploadedPhotos[type];
  const previewId = type + 'Preview';
  document.getElementById(previewId).style.display = 'none';
  document.getElementById(type + 'Photo').value = '';
}

// ===== GENERATE DESCRIPTION =====
function generateDescription() {
  const brand = document.getElementById('brandSelect').value || 'Vehicle';
  const model = document.getElementById('modelField').value || '';
  const year = document.getElementById('yearField').value || new Date().getFullYear();
  const km = document.getElementById('kmField').value || '0';
  const fuel = document.getElementById('fuelSelect').value || 'Not specified';
  const transmission = document.getElementById('transmissionSelect').value || 'Not specified';
  const insurance = document.getElementById('insuranceType').value || 'Not specified';
  const owner = document.getElementById('ownerType').value || 'Not specified';

  const desc = `üöó ${brand} ${model} (${year})

‚úî Condition: Premium Maintained
‚úî KM Driven: ${km}
‚úî Fuel Type: ${fuel}
‚úî Transmission: ${transmission}
‚úî Insurance: ${insurance}
‚úî Owner: ${owner}

üìã Key Features:
‚Ä¢ Well-maintained vehicle
‚Ä¢ Clean RC & verified documents
‚Ä¢ Non-accidental history
‚Ä¢ All original parts
‚Ä¢ Regular service records

üí∞ Ready for immediate inspection & test drive
üìç Seller verified on CABII
üîí 48-hour guaranteed deal eligible`;

  document.getElementById('descField').value = desc;
}

function updateDescription() {
  generateDescription();
}

function analyzeMarket(expectedPrice, conditionScore, market) {
  /*
    Real logic:
    - conditionScore: 40‚Äì95
    - expectedPrice vs fair market
  */
  if (conditionScore >= 85 && expectedPrice <= market.rate) {
    return "HIGH_CHANCE";
  }
  if (conditionScore >= 70 && expectedPrice <= market.rate * 1.1) {
    return "MEDIUM_CHANCE";
  }
  return "LOW_CHANCE";
}

// ===== MARKET PRICE CALCULATION =====
function calculateMarketPrice() {
  const year = parseInt(document.getElementById('yearField').value) || new Date().getFullYear();
  const km = parseInt(document.getElementById('kmField').value) || 0;
  const expectedPrice = parseInt(document.getElementById('expectedPrice').value) || 0;
  const condition = document.getElementById('conditionSelect').value || 'Good';
  const fuel = document.getElementById('fuelSelect').value;
  if (!expectedPrice) {
    document.getElementById('analysisBox').classList.remove('show');
    return;
  }

  
  
  const conditionMultiplier = {
    'Excellent': 1.20,
    'Good': 1.0,
    'Average': 0.80,
    'Fair': 0.60
  };
  
  const multiplier = conditionMultiplier[condition] || 1.0;
// ===== REAL CONDITION SCORE (0‚Äì100) =====
  let conditionScore = 80; // base

  if (condition === 'Excellent') conditionScore = 90;
  if (condition === 'Good') conditionScore = 80;
  if (condition === 'Average') conditionScore = 65;
  if (condition === 'Fair') conditionScore = 50;

  // KM penalty
  if (km > 80000) conditionScore -= 10;
  if (km > 120000) conditionScore -= 15;

  // Age penalty
  const age = new Date().getFullYear() - year;
  if (age > 8) conditionScore -= 10;
  if (age > 12) conditionScore -= 15;

  conditionScore = Math.max(40, Math.min(95, conditionScore));

  const fuelAdjustment = {
    'Diesel': 1.15,
    'Petrol': 1.0,
    'CNG': 0.85,
    'LPG': 0.80,
    'Electric': 1.25,
    'Hybrid': 1.10
  };
  
  const fuelFactor = fuelAdjustment[fuel] || 1.0;

  let low = Math.round(expectedPrice * 0.85 * multiplier * fuelFactor);
  let fair = Math.round(expectedPrice * multiplier * fuelFactor);
  let high = Math.round(expectedPrice * 1.15 * multiplier * fuelFactor);

 const finalExpectedPrice =
  parseInt(document.getElementById("expectedPrice").value) || expectedPrice;

const sellChance = analyzeMarket(finalExpectedPrice, conditionScore, {
  rate: fair
});

const guaranteeBox = document.getElementById("guaranteeBox");
const guaranteeInput = document.getElementById("guaranteeEligible");

if (sellChance === "HIGH_CHANCE") {
  guaranteeBox.innerHTML =
    "‚úÖ <span style='color:green'>Eligible for 48H Guaranteed Deal</span>";
  guaranteeInput.value = "true";
}
else if (sellChance === "MEDIUM_CHANCE") {
  guaranteeBox.innerHTML =
    "‚ö†Ô∏è <span style='color:orange'>Possible in 48H (Under Review)</span>";
  guaranteeInput.value = "true"; // allow paid review
}else {
  guaranteeBox.innerHTML =
    "‚ùå <span style='color:red'>Not Eligible for 48H Guarantee</span>";
  guaranteeInput.value = "false";
}

  low = Math.max(150000, low);
  fair = Math.max(200000, fair);
  high = Math.max(250000, high);

  document.getElementById('lowPrice').textContent = '‚Çπ' + low.toLocaleString('en-IN');
  document.getElementById('fairPrice').textContent = '‚Çπ' + fair.toLocaleString('en-IN');
  document.getElementById('highPrice').textContent = '‚Çπ' + high.toLocaleString('en-IN');

  let status = 'Competitive';
  if (expectedPrice < low) status = '‚úÖ Below Market - Good Deal';
 else if (finalExpectedPrice > high) status = '‚ö†Ô∏è Above Market - May Be Slow';
else if (finalExpectedPrice > fair) status = 'üìà Slightly Above Fair';
  document.getElementById('priceStatus').textContent = status;
  document.getElementById('analysisBox').classList.add('show');

  // Show professional modal
  document.getElementById('modalLowPrice').textContent = '‚Çπ' + low.toLocaleString('en-IN');
  document.getElementById('modalHighPrice').textContent = '‚Çπ' + high.toLocaleString('en-IN');
  document.getElementById('modalFairPrice').textContent = '‚Çπ' + fair.toLocaleString('en-IN');
  document.getElementById('modalYourPrice').textContent = '‚Çπ' + expectedPrice.toLocaleString('en-IN');
  document.getElementById('modalPriceStatus').textContent = status;
  // ===== SHOW ANALYSIS MODAL ONLY ONCE =====
const analysisModal = document.getElementById('analysisModal');

if (!sessionStorage.getItem('analysisShown')) {
  analysisModal.classList.add('show');
  sessionStorage.setItem('analysisShown', 'true');
}
}
// ===== PHOTO MODAL =====
function showPhotoModal() {
  const grid = document.getElementById('photoGrid');
  grid.innerHTML = '';
  
  if (Object.keys(uploadedPhotos).length === 0) {
    grid.innerHTML = '<p style="color: #666; padding: 20px; text-align: center;">No photos uploaded yet</p>';
  } else {
    Object.entries(uploadedPhotos).forEach(([key, photo]) => {
      grid.innerHTML += `
        <div class="photo-modal-item">
          <img src="${photo.preview}" alt="${photo.name}">
          <div class="photo-name">${photo.name}</div>
        </div>
      `;
    });
  }
  
  document.getElementById('photoModal').classList.add('show');
}

function closePhotoModal() {
  document.getElementById('photoModal').classList.remove('show');
}

function closeAnalysisModal() {
  document.getElementById('analysisModal').classList.remove('show');
}

function openZoom(imageSrc, photoName) {
  document.getElementById('zoomImage').src = imageSrc;
  document.getElementById('zoomPhotoName').textContent = photoName;
  document.getElementById('zoomModal').classList.add('show');
}

function closeZoomModal() {
  document.getElementById('zoomModal').classList.remove('show');
}

// Close zoom modal when clicking outside
document.addEventListener('click', function(e) {
  const zoomModal = document.getElementById('zoomModal');
  if (e.target === zoomModal) {
    closeZoomModal();
  }
});

// Close zoom modal with Escape key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    closeZoomModal();
  }
});
function canUserPostSell48() {
  const user = JSON.parse(localStorage.getItem("cabiiUser"));
  if (!user) return false;

  // first free sell48
  if (!user.sell48Count) return true;

  // paid packs
  if (user.sell48Pack && user.sell48Remaining > 0) return true;

  return false;
}
// ===== FORM SUBMISSION =====

form.addEventListener('submit', async e => {
  e.preventDefault();

  // üîê PAYMENT LOCK
  const isEligible =
  document.getElementById("guaranteeEligible").value === "true";

if (!isEligible) {
  alert("‚ùå This vehicle is NOT eligible for 48H Guaranteed Deal.\nYou can post a normal ad instead.");
  return;
}

if (!window.sell48PaymentDone) {
  alert("‚Çπ49 payment required for 48H Guaranteed Deal");
  startPayment(49);
  return;
}
    

  if (!document.getElementById('sellerName').value) {
    errorMsg.textContent = '‚ùå Name is required';
    errorMsg.classList.add('show');
    return;
  }
  
  if (!document.getElementById('sellerPhone').value.match(/^[0-9]{10}$/)) {
    errorMsg.textContent = '‚ùå Valid 10-digit phone required';
    errorMsg.classList.add('show');
    return;
  }

  const requiredPhotos = ['front', 'back', 'roof', 'right', 'left', 'km', 'interior'];

  for (let photo of requiredPhotos) {
    if (!uploadedPhotos[photo]) {
      errorMsg.textContent = `‚ùå ${photo.toUpperCase()} photo is required`;
      errorMsg.classList.add('show');
      return;
    }
  }

  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span> Processing...';

  try {
    const fd = new FormData();
    fd.append('brand', document.getElementById('brandSelect').value);
    fd.append('model', document.getElementById('modelField').value);
    fd.append('year', document.getElementById('yearField').value);
    fd.append('km', document.getElementById('kmField').value);
    fd.append('fuel', document.getElementById('fuelSelect').value);
    fd.append('transmission', document.getElementById('transmissionSelect').value);
    fd.append('insurance', document.getElementById('insuranceType').value);
    fd.append('owner', document.getElementById('ownerType').value);
    fd.append('condition', document.getElementById('conditionSelect').value);
    fd.append('description', document.getElementById('descField').value);
    fd.append('expectedPrice', document.getElementById('expectedPrice').value);
    fd.append('sellerName', document.getElementById('sellerName').value);
    fd.append('phone', document.getElementById('sellerPhone').value);
    fd.append('whatsappNum', document.getElementById('whatsappNum').value || document.getElementById('sellerPhone').value);
    fd.append('city', document.getElementById('sellerCity').value);
    fd.append('membership', selectedMembership);
    fd.append('membershipPrice', membershipPrice);
    fd.append('membershipLeads', membershipLeads);
fd.append('membershipMonths', membershipMonths);
fd.append('adType', 'SELL48');
fd.append("paymentId", window.sell48PaymentId);
fd.append("paymentAmount", 49);
    Object.entries(uploadedPhotos).forEach(([key, photo]) => {
      fd.append(`photo_${key}`, photo.file);
    });

   const res = await fetch('https://www.carsandbikesinindia.com/api/sell48/submit', {
  method: 'POST',
  credentials: 'include',
  body: fd
});
    const data = await res.json();

    if (res.ok) {
      successMsg.innerHTML = `‚úÖ <b>Approved for 48H Guaranteed Sell!</b><br>Your ad is live. Dealers will contact you on WhatsApp within 48 hours.`;
      successMsg.classList.add('show');
      errorMsg.classList.remove('show');

      form.style.display = 'none';
      
      notifyDealers(data.adId, document.getElementById('brandSelect').value, document.getElementById('modelField').value, document.getElementById('expectedPrice').value);
    } else {
      throw new Error(data.message || 'Submission failed');
    }
  } catch (err) {
    errorMsg.textContent = '‚ùå Error: ' + err.message;
    errorMsg.classList.add('show');
  } finally {
    btn.disabled = false;
    btn.innerHTML = 'üöÄ Post 48H Guarantee Ad';
  }
});

// ===== NOTIFY DEALERS VIA WHATSAPP =====
function notifyDealers(adId, brand, model, price) {
  console.log(`üì± WhatsApp notifications sent to all dealers about: ${brand} ${model} - ‚Çπ${price}`);
  
  fetch('https://www.carsandbikesinindia.com/api/sell48/notify-dealers', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ adId, brand, model, price, membership: selectedMembership })
  }).catch(e => console.log('Notification sent'));
}

// ===== INITIALIZATION =====
// Seller can post directly (‚Çπ49 payment handles access)
formContainer.classList.add('show');
generateDescription();
// ===== CLICK MARKET PRICE TO AUTO-SELECT =====
function applyPriceAndRecheck(price) {
  document.getElementById("expectedPrice").value = price;
  calculateMarketPrice();
}

document.getElementById("fairPrice").addEventListener("click", () => {
  const value = document.getElementById("fairPrice").innerText.replace(/[‚Çπ,]/g, "");
  applyPriceAndRecheck(parseInt(value));
});

document.getElementById("lowPrice").addEventListener("click", () => {
  const value = document.getElementById("lowPrice").innerText.replace(/[‚Çπ,]/g, "");
  applyPriceAndRecheck(parseInt(value));
});

document.getElementById("highPrice").addEventListener("click", () => {
  const value = document.getElementById("highPrice").innerText.replace(/[‚Çπ,]/g, "");
  applyPriceAndRecheck(parseInt(value));
});
</script>
<script>
/**
 * üîê SELL48 ‚Çπ49 PAYMENT HANDLER
 * - Mandatory payment
 * - Backend order create
 * - Razorpay popup
 * - Backend verification
 * - Unlock form only after success
 */

async function startPayment(amount) {
  try {
    // üîπ 1Ô∏è‚É£ Create Razorpay order from backend
    const res = await fetch(
      "https://www.carsandbikesinindia.com/api/payment/create-order",
      {
        method: "POST",
        credentials: "include",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount })
      }
    );

    if (!res.ok) {
      alert("‚ùå Unable to start payment. Try again.");
      return;
    }

    const order = await res.json();

    if (!order || order.disabled) {
      alert("‚ùå Payment system not active yet");
      return;
    }

    // üîπ 2Ô∏è‚É£ Razorpay options
    const options = {
      key: "RAZORPAY_KEY_ID_HERE", // ‚ö†Ô∏è Replace with LIVE / TEST key
      amount: order.amount,       // amount in paise
      currency: "INR",
      name: "Cars And Bikes In India (CABII)",
      description: "Sell in 48 Hours ‚Äì Guaranteed Deal",
      order_id: order.id,

      handler: async function (response) {
        try {
          // üîπ 3Ô∏è‚É£ Verify payment from backend
          const verifyRes = await fetch(
            "https://www.carsandbikesinindia.com/api/payment/verify",
            {
              method: "POST",
              credentials: "include",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                razorpay_payment_id: response.razorpay_payment_id,
                razorpay_order_id: response.razorpay_order_id,
                razorpay_signature: response.razorpay_signature
              })
            }
          );

          const result = await verifyRes.json();

          if (verifyRes.ok && result.success) {
            // üîì PAYMENT SUCCESS ‚Üí UNLOCK FORM
            window.sell48PaymentDone = true;
            window.sell48PaymentId = response.razorpay_payment_id;

            alert("‚úÖ ‚Çπ49 Payment Successful!\nNow click 'Post 48H Guarantee Ad' to submit.");

          } else {
            alert("‚ùå Payment verification failed. Amount not confirmed.");
          }

        } catch (err) {
          console.error("Verification error:", err);
          alert("‚ùå Payment verification error");
        }
      },

      modal: {
        ondismiss: function () {
          console.log("Payment popup closed by user");
        }
      },

      theme: {
        color: "#dc2626"
      }
    };

    // üîπ 4Ô∏è‚É£ Open Razorpay popup
    const rzp = new Razorpay(options);
    rzp.open();

  } catch (err) {
    console.error("Payment init error:", err);
    alert("‚ùå Payment error. Please try again.");
  }
}
</script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

</body>
</html>

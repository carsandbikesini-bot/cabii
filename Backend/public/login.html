<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login | Cars And Bikes In India - CABII</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:Arial, Helvetica, sans-serif;
}

body{
background:#f4f6f8;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
}

.container{
width:380px;
background:#fff;
padding:28px;
border-radius:14px;
box-shadow:0 15px 40px rgba(0,0,0,0.15);
text-align:center;
}

.logo{
height:60px;
margin-bottom:10px;
}

.title{
font-size:18px;
font-weight:800;
margin-bottom:20px;
background:linear-gradient(120deg,#c0c0c0,#ffd700,#ffffff,#ffd700,#c0c0c0);
background-size:300% auto;
-webkit-backgroundclip:text;
color:transparent;
animation:shine 4s linear infinite;
}

@keyframes shine{
0%{background-position:0%}
100%{background-position:300%}
}

input{
width:100%;
padding:12px;
margin-bottom:12px;
border-radius:6px;
border:1px solid #ccc;
font-size:14px;
}

button{
width:100%;
padding:12px;
border:none;
border-radius:6px;
font-size:15px;
font-weight:700;
cursor:pointer;
margin-bottom:10px;
transition:0.2s;
}

.login{background:#f97316;color:#fff;}
.signup{background:#16a34a;color:#fff;}

button:disabled{
opacity:0.6;
cursor:not-allowed;
}

.note{
font-size:13px;
color:#555;
margin-top:10px;
}
</style>
</head>

<body>

<div class="container">

<img src="images/logo.png" class="logo">
<div class="title">Cars And Bikes In India â€“ CABII</div>

<input type="text" id="name" placeholder="Name (signup only)">
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">

<button id="loginBtn" class="login">Login</button>
<button id="signupBtn" class="signup">Create New Account</button>

<div style="margin-top:10px;font-size:13px;">
<a href="#" id="forgot">Forgot Password?</a>
</div>

<div class="note">ðŸ”’ Secure â€¢ âœ” Verified â€¢ Trusted Platform</div>
</div>

<script>

/* IMPORTANT: SAME DOMAIN API */
const API = ""; // empty means same domain (VERY IMPORTANT)

/* elements */
const nameEl = document.getElementById("name");
const emailEl = document.getElementById("email");
const passEl = document.getElementById("password");
const loginBtn = document.getElementById("loginBtn");
const signupBtn = document.getElementById("signupBtn");

/* loading */
function loading(btn,state){
btn.disabled=state;
btn.textContent=state?"Please wait...":btn.dataset.text;
}
loginBtn.dataset.text="Login";
signupBtn.dataset.text="Create New Account";

/* LOGIN */
loginBtn.onclick=async()=>{

const email=emailEl.value.trim();
const password=passEl.value.trim();

if(!email||!password){
alert("Enter email and password");
return;
}

loading(loginBtn,true);

try{

const res=await fetch(API +"/api/login",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
credentials:"include",
body:JSON.stringify({email,password})
});

const data=await res.json();

if(!data.success){
alert(data.message||"Login failed");
loading(loginBtn,false);
return;
}

/* SAVE USER */
localStorage.setItem("cabiiUser",JSON.stringify(data.user));

/* REDIRECT */
window.location.href="/";

}catch(e){
alert("Server not responding");
}

loading(loginBtn,false);
};

/* SIGNUP */
signupBtn.onclick=async()=>{

const name=nameEl.value.trim();
const email=emailEl.value.trim();
const password=passEl.value.trim();

if(!name||!email||!password){
alert("Fill all fields");
return;
}

loading(signupBtn,true);

try{

const res=await fetch("/api/register",{
method:"POST",
headers:{
"Content-Type":"application/json"
},
credentials:"include",
body:JSON.stringify({name,email,password})
});

const data=await res.json();

if(!data.success){
alert(data.message||"Signup failed");
loading(signupBtn,false);
return;
}

alert("Account created. Now login.");
loading(signupBtn,false);

}catch{
alert("Server error");
loading(signupBtn,false);
}
};

/* FORGOT PASSWORD */
document.getElementById("forgot").onclick=async(e)=>{
e.preventDefault();

const email=prompt("Enter your registered email");
if(!email) return;

await fetch("/api/auth/forgot-password",{
method:"POST",
headers:{"Content-Type":"application/json"},
credentials:"include",
body:JSON.stringify({email})
});

alert("If email exists, reset link generated (check server log)");
};

</script>
</body>
</html>